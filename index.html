<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PUK Feedback Form</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Lucide Icons CDN -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        /* Kurdish-supporting font */
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+Arabic:wght@300;400;500;600;700&display=swap');

        /* Font Awesome icons */
        @import url('https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css');

        /* Apply the font globally */
        body {
            font-family: 'Noto Sans Arabic', sans-serif;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        @keyframes slideInLeft {
            from { 
                opacity: 0;
                transform: translateX(-20px);
            }
            to { 
                opacity: 1;
                transform: translateX(0);
            }
        }
        
        @keyframes slideInRight {
            from { 
                opacity: 0;
                transform: translateX(20px);
            }
            to { 
                opacity: 1;
                transform: translateX(0);
            }
        }
        
        @keyframes slideInUp {
            from { 
                opacity: 0;
                transform: translateY(20px);
            }
            to { 
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @keyframes slideInDown {
            from { 
                opacity: 0;
                transform: translateY(-20px);
            }
            to { 
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-5px); }
        }
        
        @keyframes pulseSlow {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }
        
        @keyframes shine {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }
        
        @keyframes spinSlow {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        
        @keyframes orbit {
            0% { transform: rotate(0deg) translateX(8px) rotate(0deg); }
            100% { transform: rotate(360deg) translateX(8px) rotate(-360deg); }
        }
        
        @keyframes tilt {
            0%, 100% { transform: rotate(0deg); }
            25% { transform: rotate(0.5deg); }
            75% { transform: rotate(-0.5deg); }
        }
        
        .animate-fadeIn {
            animation: fadeIn 0.6s ease-out forwards;
        }
        
        .animate-slideInLeft {
            animation: fadeIn 0.6s ease-out forwards, slideInLeft 0.6s ease-out forwards;
        }
        
        .animate-slideInRight {
            animation: fadeIn 0.6s ease-out forwards, slideInRight 0.6s ease-out forwards;
        }
        
        .animate-slideInUp {
            animation: fadeIn 0.6s ease-out forwards, slideInUp 0.6s ease-out forwards;
        }
        
        .animate-slideInDown {
            animation: fadeIn 0.6s ease-out forwards, slideInDown 0.6s ease-out forwards;
        }
        
        .animate-float {
            animation: float 3s ease-in-out infinite;
        }
        
        .animate-pulse-slow {
            animation: pulseSlow 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }
        
        .animate-shine {
            animation: shine 1.5s ease-in-out infinite;
        }
        
        .animate-spin-slow {
            animation: spinSlow 3s linear infinite;
        }
        
        .animate-orbit {
            animation: orbit 2s linear infinite;
        }
        
        .animate-tilt {
            animation: tilt 10s ease-in-out infinite;
        }
        
        .pattern-grid {
            background-image: linear-gradient(rgba(0, 0, 0, 0.1) 1px, transparent 1px),
                              linear-gradient(90deg, rgba(0, 0, 0, 0.1) 1px, transparent 1px);
            background-size: 20px 20px;
        }
        
        .pattern-dots {
            background-image: radial-gradient(rgba(0, 0, 0, 0.1) 1px, transparent 1px);
            background-size: 10px 10px;
        }
        
        .pattern-zigzag {
            background: linear-gradient(135deg, rgba(0, 0, 0, 0.05) 25%, transparent 25%) -10px 0,
                        linear-gradient(225deg, rgba(0, 0, 0, 0.05) 25%, transparent 25%) -10px 0,
                        linear-gradient(315deg, rgba(0, 0, 0, 0.05) 25%, transparent 25%),
                        linear-gradient(45deg, rgba(0, 0, 0, 0.05) 25%, transparent 25%);
            background-size: 20px 20px;
        }
        
        .pattern-wave {
            background: radial-gradient(circle at 100% 50%, transparent 20%, rgba(0, 0, 0, 0.1) 21%, rgba(0, 0, 0, 0.1) 34%, transparent 35%, transparent),
                        radial-gradient(circle at 0% 50%, transparent 20%, rgba(0, 0, 0, 0.1) 21%, rgba(0, 0, 0, 0.1) 34%, transparent 35%, transparent);
            background-size: 20px 20px;
        }
        
        .pattern-diagonal {
            background: repeating-linear-gradient(45deg, transparent, transparent 10px, rgba(0, 0, 0, 0.05) 10px, rgba(0, 0, 0, 0.05) 20px);
        }
        
        .dropzone {
            transition: all 0.2s ease;
        }
        
        .dropzone:hover {
            border-color: #10b981;
            background-color: #f0fdf4;
        }
        
        [dir="rtl"] {
            direction: rtl;
            text-align: right;
        }
        
        [dir="ltr"] {
            direction: ltr;
            text-align: left;
        }
        
        /* Custom styles for validation */
        .validation-error {
            border-color: #f87171 !important;
        }
        
        .file-input-hidden {
            opacity: 0;
            position: absolute;
            z-index: -1;
        }
        
        .file-preview-container {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-top: 0.5rem;
        }
        
        .file-preview {
            background-color: #f0fdf4;
            border: 1px solid #bbf7d0;
            border-radius: 0.5rem;
            padding: 0.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.875rem;
        }
        
        .file-preview-remove {
            cursor: pointer;
            color: #ef4444;
        }
        
        /* Custom styles for request type selection */
        .request-type-card {
            transition: all 0.3s ease;
        }
        
        .request-type-card.selected {
            transform: scale(1.02);
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        }
        
        /* Predefined color classes for request types */
        .request-type-project {
            background: linear-gradient(to bottom right, #60a5fa, #3b82f6, #2563eb);
            color: white;
        }
        
        .request-type-suggestion {
            background: linear-gradient(to bottom right, #fbbf24, #f59e0b, #d97706);
            color: white;
        }
        
        .request-type-complaint {
            background: linear-gradient(to bottom right, #f87171, #ef4444, #dc2626);
            color: white;
        }
        
        .request-type-general {
            background: linear-gradient(to bottom right, #34d399, #10b981, #059669);
            color: white;
        }
    </style>
</head>
<body class="min-h-screen flex flex-col bg-gray-50" dir="rtl">
    <!-- Background -->
    <div class="fixed inset-0 pointer-events-none overflow-hidden z-0">
        <div class="absolute inset-0 pattern-grid opacity-5"></div>
        <div class="absolute top-0 right-0 w-[40%] h-[40%] bg-gradient-to-bl from-green-300/20 to-green-600/10 rounded-bl-[100%] blur-3xl"></div>
        <div class="absolute bottom-0 left-0 w-[40%] h-[40%] bg-gradient-to-tr from-green-300/20 to-green-600/10 rounded-tr-[100%] blur-3xl"></div>
        
        <div class="absolute top-[10%] left-[10%] w-32 h-32 border-8 border-green-100 rounded-full opacity-30 animate-float" style="animation-delay: 0s;"></div>
        <div class="absolute top-[15%] left-[15%] w-16 h-16 border-4 border-green-200 rounded-full opacity-20 animate-float" style="animation-delay: 1.5s;"></div>
        <div class="absolute top-[60%] right-[10%] w-40 h-40 border-8 border-green-100 rounded-full opacity-30 animate-float" style="animation-delay: 1s;"></div>
        <div class="absolute top-[65%] right-[15%] w-20 h-20 border-4 border-green-200 rounded-full opacity-20 animate-float" style="animation-delay: 2.5s;"></div>
        
        <div class="absolute top-0 left-[20%] w-px h-[30vh] bg-gradient-to-b from-green-200/0 via-green-300/40 to-green-200/0 animate-pulse-slow" style="animation-delay: 0s;"></div>
        <div class="absolute top-0 left-[40%] w-px h-[45vh] bg-gradient-to-b from-green-200/0 via-green-300/30 to-green-200/0 animate-pulse-slow" style="animation-delay: 1s;"></div>
        <div class="absolute top-0 left-[60%] w-px h-[35vh] bg-gradient-to-b from-green-200/0 via-green-300/40 to-green-200/0 animate-pulse-slow" style="animation-delay: 2s;"></div>
        <div class="absolute top-0 left-[80%] w-px h-[40vh] bg-gradient-to-b from-green-200/0 via-green-300/30 to-green-200/0 animate-pulse-slow" style="animation-delay: 3s;"></div>
        
        <div class="absolute bottom-0 left-[20%] w-px h-[30vh] bg-gradient-to-t from-green-200/0 via-green-300/40 to-green-200/0 animate-pulse-slow" style="animation-delay: 2s;"></div>
        <div class="absolute bottom-0 left-[40%] w-px h-[45vh] bg-gradient-to-t from-green-200/0 via-green-300/30 to-green-200/0 animate-pulse-slow" style="animation-delay: 3s;"></div>
        <div class="absolute bottom-0 left-[60%] w-px h-[35vh] bg-gradient-to-t from-green-200/0 via-green-300/40 to-green-200/0 animate-pulse-slow" style="animation-delay: 0s;"></div>
        <div class="absolute bottom-0 left-[80%] w-px h-[40vh] bg-gradient-to-t from-green-200/0 via-green-300/30 to-green-200/0 animate-pulse-slow" style="animation-delay: 1s;"></div>
        
        <div class="absolute inset-0 pattern-dots opacity-10"></div>
    </div>

    <!-- Header -->
    <header class="relative overflow-hidden border-b border-green-100" 
            style="height: 130px; background: url('https://d2wqffb2bc8st5.cloudfront.net/resources/files/2017/10/MamJalal%20(2).jpg') center/100% 100% no-repeat;">

      <!-- Green gradient overlay -->
      <div class="absolute inset-0 bg-gradient-to-r from-green-400 via-green-500 to-green-600 opacity-50 z-0"></div>

      <!-- Header content -->
      <div class="container mx-auto px-4 sm:px-6 h-full relative z-10">
        <div class="flex items-center justify-between h-full">
          
          <!-- Left (Title + Subtitle) -->
          <div class="flex items-center gap-3 sm:gap-6 animate-slideInLeft" style="animation-delay: 0.3s;">
            <div class="space-y-0.5 sm:space-y-1">
              <h1 id="headerTitle" class="text-xl sm:text-3xl font-bold text-white">فۆرمی فیدباک</h1>
              <div class="flex items-center gap-2">
                <div class="h-0.5 w-4 sm:w-6 bg-white"></div>
                <p id="headerSubtitle" class="text-xs sm:text-sm text-white">یەکێتی نیشتیمانیی کوردستان</p>
              </div>
            </div>
          </div>

          <!-- Right (Language Button) -->
          <div class="animate-slideInRight" style="animation-delay: 0.3s;">
            <button id="languageButton" 
                    class="relative flex items-center gap-1 sm:gap-2 py-1.5 sm:py-2 px-1 sm:px-4 rounded-full 
                           bg-gradient-to-r from-green-50 to-white border border-green-100 text-green-700 
                           hover:shadow-md hover:border-green-200 transition-all group animate-float">
              <i data-lucide="globe" class="w-4 h-4 sm:w-5 sm:h-5 text-green-500 animate-pulse-slow"></i>
              <span id="languageButtonText" class="font-medium text-xs sm:text-sm">کوردی</span>
              <i data-lucide="chevron-down" class="w-3 h-3 sm:w-4 sm:h-4 text-green-500 group-hover:rotate-180 transition-transform duration-300"></i>
              <div class="absolute inset-0 rounded-full border border-green-300/50 animate-ping opacity-30"></div>
            </button>
          </div>

        </div>
      </div>
    </header>

    <!-- Main Content -->
    <main class="container mx-auto px-4 sm:px-6 py-8 sm:py-12 flex-grow relative">
        <div class="absolute inset-0 pointer-events-none">
            <div class="absolute top-20 left-10 w-40 sm:w-64 h-40 sm:h-64 border border-green-100 rounded-full opacity-30"></div>
            <div class="absolute top-40 left-20 w-20 sm:w-32 h-20 sm:h-32 border border-green-100 rounded-full opacity-20"></div>
            <div class="absolute bottom-20 right-10 w-40 sm:w-64 h-40 sm:h-64 border border-green-100 rounded-full opacity-30"></div>
            <div class="absolute bottom-40 right-20 w-20 sm:w-32 h-20 sm:h-32 border border-green-100 rounded-full opacity-20"></div>
        </div>
        
        <div class="max-w-4xl mx-auto relative animate-fadeIn" style="animation-delay: 0.3s;">
            <!-- Progress Bar -->
            <div class="mb-6 sm:mb-10 relative animate-slideInDown" style="animation-delay: 0.4s;">
                <div class="p-4 sm:p-6 bg-white rounded-2xl shadow-sm border border-green-100">
                    <div class="overflow-hidden h-2 mb-4 sm:mb-6 rounded-full bg-gray-100 relative">
                        <div class="h-full bg-gradient-to-r from-green-400 via-green-500 to-green-600 transition-all duration-700 ease-out rounded-full relative overflow-hidden" style="width: 0%;" id="progressBar">
                            <div class="absolute inset-0 bg-gradient-to-r from-transparent via-white/30 to-transparent -translate-x-full animate-shine"></div>
                        </div>
                        <div class="absolute top-6 transition-all duration-700" style="left: 0%; transform: translateX(-50%);" id="progressPercentage">
                            <div class="text-xs font-medium text-green-600">0%</div>
                        </div>
                    </div>
                    
                    <div class="flex justify-between" id="progressSteps">
                        <!-- Steps will be populated by JavaScript -->
                    </div>
                </div>
    </div>
            
            <!-- Form Container -->
            <div class="bg-white rounded-2xl sm:rounded-3xl shadow-xl p-4 sm:p-8 mb-6 sm:mb-10 relative overflow-hidden border border-green-50 animate-slideInUp" style="animation-delay: 0.5s;">
                <div class="absolute top-0 left-0 w-24 sm:w-32 h-24 sm:h-32 bg-green-50 rounded-br-[100%] opacity-70"></div>
                <div class="absolute bottom-0 right-0 w-24 sm:w-32 h-24 sm:h-32 bg-green-50 rounded-tl-[100%] opacity-70"></div>
                <div class="absolute inset-0 pattern-diagonal opacity-5"></div>
                
                <div class="relative" id="formContent">
                    <!-- Form content will be populated by JavaScript -->
                </div>
            </div>
        </div>
    </main>

   <!-- Footer -->
<footer class="bg-white relative overflow-hidden border-t border-green-100">
    <div class="container mx-auto px-4 sm:px-6 py-6 sm:py-8 relative z-10">
        <div class="flex flex-col md:flex-row items-center justify-between gap-4 sm:gap-6">
            
            <!-- Left side: Logo + Copyright -->
            <div class="flex items-center gap-3 animate-slideInLeft" style="animation-delay: 0.3s;">
                <img
                    src="https://thekurdishproject.org/wp-content/uploads/2015/02/5920151422013_puk.png"
                    alt="avatar"
                    class="w-10 h-10 sm:w-12 sm:h-12 rounded-full object-cover object-center"
                />
                <span id="footerCopyright" class="text-sm text-gray-600">
                    © 2025 یەکێتی نیشتیمانیی کوردستان
                </span>
            </div>
            
            <!-- Right side: Links -->
            <div class="flex items-center gap-3 sm:gap-6 flex-wrap justify-center animate-slideInRight" style="animation-delay: 0.3s;">
                <a href="#" class="text-xs sm:text-sm text-gray-500 hover:text-green-600 transition-colors relative group flex items-center gap-1">
                    <i data-lucide="shield" class="w-3 h-3 opacity-70"></i>
                    <span id="footerPrivacy">سیاسەتی تایبەتمەندی</span>
                    <span class="absolute bottom-0 left-0 w-0 h-0.5 bg-gradient-to-r from-green-400 to-green-600 group-hover:w-full transition-all duration-300"></span>
                </a>
                <a href="#" class="text-xs sm:text-sm text-gray-500 hover:text-green-600 transition-colors relative group">
                    <span id="footerTerms">مەرجەکانی خزمەتگوزاری</span>
                    <span class="absolute bottom-0 left-0 w-0 h-0.5 bg-gradient-to-r from-green-400 to-green-600 group-hover:w-full transition-all duration-300"></span>
                </a>
                <a href="#" class="text-xs sm:text-sm text-gray-500 hover:text-green-600 transition-colors relative group flex items-center gap-1">
                    <span id="footerContact">پەیوەندی</span>
                    <i data-lucide="external-link" class="w-3 h-3 opacity-70"></i>
                    <span class="absolute bottom-0 left-0 w-0 h-0.5 bg-gradient-to-r from-green-400 to-green-600 group-hover:w-full transition-all duration-300"></span>
                </a>
            </div>
        </div>
    </div>
</footer>


    <!-- Location Modal -->
    <div id="locationModal" class="fixed inset-0 flex items-center justify-center z-50 bg-black/50 backdrop-blur-sm hidden">
        <div class="relative bg-white w-11/12 max-w-md rounded-2xl sm:rounded-3xl shadow-2xl overflow-hidden animate-fadeIn" style="animation-delay: 0.2s;">
            <div class="absolute inset-0 pattern-dots opacity-5"></div>
            <div class="absolute top-0 inset-x-0 h-2 bg-gradient-to-r from-green-400 via-green-500 to-green-400"></div>
            
            <!-- HEADER -->
            <div class="relative p-6 sm:p-8 bg-gradient-to-br from-green-400 via-green-500 to-green-600">
                <div class="absolute inset-0 bg-green-500 pattern-wave opacity-10"></div> 
                
                <div class="flex items-center gap-4 sm:gap-5 relative z-10">
                    <div class="relative bg-white shadow-lg w-12 h-12 sm:w-14 sm:h-14 flex items-center justify-center rounded-full animate-float" style="animation-delay: 0s;">
                        <div class="absolute inset-0 rounded-full border-4 border-white/30 animate-ping opacity-30"></div>
                        <i data-lucide="map-pin" class="w-6 h-6 sm:w-7 sm:h-7 text-green-500"></i>
                    </div>
                    <div>
                        <h2 id="locationModalTitle" class="text-xl sm:text-2xl font-bold text-white">دەستگەیشتن بە شوێن</h2>
                        <p id="locationModalSubtitle" class="text-white text-xs sm:text-sm mt-1">چالاککردنی خزمەتگوزاریەکانی شوێنی ورد</p>
                    </div>
                </div>
            </div>
            
            <!-- BODY -->
            <div class="p-6 sm:p-8 relative">
                <p id="locationModalDescription" class="text-sm sm:text-base text-gray-600 mb-6 sm:mb-8 leading-relaxed text-right">
                    ئێمە پێویستمان بە شوێنی ئێوەیە بۆ پێشکەشکردنی خزمەتگوزاری باشتر. ئەمە یارمەتیمان دەدات بۆ پەیوەندی کردن لەگەڵ خزمەتگوزاریەکان و زانیاریەکانی پەیوەندیدار بە ناوچەکەت.
                </p>
                
                <div class="flex gap-3 sm:gap-4">
                    <button id="locationAllowButton" class="flex-1 px-4 sm:px-6 py-3 sm:py-4 rounded-lg sm:rounded-xl bg-gradient-to-r from-green-500 to-green-600 text-white font-medium text-sm sm:text-base hover:from-green-600 hover:to-green-700 transition-all shadow-lg shadow-green-500/20 flex items-center justify-center gap-2 relative overflow-hidden group">
                        <div class="absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent -translate-x-full group-hover:translate-x-full transition-transform duration-1000"></div>
                        <i data-lucide="shield-check" class="w-4 h-4 sm:w-5 sm:h-5"></i>
                        <span>ڕێگەدان</span>
                    </button>
                    <button id="locationDenyButton" class="flex-1 px-4 sm:px-6 py-3 sm:py-4 rounded-lg sm:rounded-xl bg-gray-100 text-gray-700 font-medium text-sm sm:text-base hover:bg-gray-200 transition-colors flex items-center justify-center gap-2 border border-gray-200 relative overflow-hidden group">
                        <div class="absolute inset-0 bg-gradient-to-r from-transparent via-gray-200/50 to-transparent -translate-x-full group-hover:translate-x-full transition-transform duration-1000"></div>
                        <i data-lucide="x" class="w-4 h-4 sm:w-5 sm:h-5"></i>
                        <span>ڕەتکردنەوە</span>
                    </button>
                </div>
                
                <p id="locationModalFooter" class="text-xs text-gray-400 mt-5 sm:mt-6 text-center">
                    تایبەتمەندی ئێوە گرنگە بۆ ئێمە. داتای شوێنی ئێوە تەنها بەکاردێت بۆ باشترکردنی ئەزموونەکەت.
                </p>
            </div>
        </div>
    </div>

    <!-- Language Modal -->
    <div id="languageModal" class="fixed inset-0 flex items-center justify-center z-50 bg-black/50 backdrop-blur-sm hidden">
      <div class="relative bg-white w-11/12 max-w-md rounded-2xl sm:rounded-3xl shadow-2xl overflow-hidden animate-fadeIn" style="animation-delay: 0.2s;">
        <div class="absolute inset-0 pattern-dots opacity-5"></div>
        <div class="absolute top-0 inset-x-0 h-2 bg-gradient-to-r from-green-400 via-green-500 to-green-400"></div>
        
        <!-- Modal header with gradient -->
        <div class="relative p-6 sm:p-8 bg-gradient-to-br from-green-400 via-green-500 to-green-600">
          <div class="absolute inset-0 bg-green-500 pattern-wave opacity-20"></div>
          
          <div class="flex items-center gap-4 sm:gap-5 relative z-10">
            
            <!-- Updated globe icon with float + ping -->
            <div class="relative bg-white shadow-lg w-12 h-12 sm:w-14 sm:h-14 flex items-center justify-center rounded-full animate-float">
              <div class="absolute inset-0 rounded-full border-4 border-white/30 animate-ping opacity-30"></div>
              <i data-lucide="globe" class="w-6 h-6 sm:w-7 sm:h-7 text-green-500"></i>
            </div>
            
            <!-- Title + Subtitle -->
            <div>
              <h2 id="languageModalTitle" class="text-xl sm:text-2xl font-bold text-white drop-shadow-md">
                زمان هەڵبژێرە
              </h2>
              <p id="languageModalSubtitle" class="text-white text-xs sm:text-sm mt-1 drop-shadow-md">
                زمانی دڵخوازی خۆت هەڵبژێرە
              </p>
            </div>
          </div>
        </div>
        
        <!-- Options -->
        <div class="p-6 sm:p-8 grid grid-cols-1 gap-3 sm:gap-4" id="languageOptions">
          <!-- Language options will be populated by JavaScript -->
        </div>
        
        <div class="px-6 sm:px-8 pb-6 sm:pb-8">
          <p id="languageModalFooter" class="text-xs text-gray-400 text-center">
            هەڵبژاردنی زمانەکەت بۆ سەردانەکانی داهاتوو پاشەکەوت دەکرێت
          </p>
        </div>
      </div>
    </div>

    <script>
        // Initialize Lucide icons
        lucide.createIcons();
        
        // App state
        const state = {
            currentStep: 0,
            submitted: false,
            currentLanguage: 'ku',
            direction: 'rtl',
            showLocationModal: true,
            showLanguageModal: false,
            formData: {
                requestType: '',
                name: '',
                phone: '',
                description: '',
                files: []
            }
        };
        
        // Text content for different languages
        const texts = {
            en: {
                header: {
                    title: 'Feedback Form',
                    subtitle: 'Patriotic Union of Kurdistan'
                },
                footer: {
                    copyright: '© 2025 Patriotic Union of Kurdistan',
                    privacy: 'Privacy Policy',
                    terms: 'Terms of Service',
                    contact: 'Contact'
                },
                progressSteps: [
                    'Request Type',
                    'Personal Information',
                    'Details',
                    'Confirmation'
                ],
                requestType: {
                    title: 'Request Type',
                    subtitle: 'Share your thoughts with us',
                    next: 'Next',
                    requestTypes: {
                        project: 'Project',
                        suggestion: 'Suggestion',
                        complaint: 'Complaint',
                        general: 'General Request'
                    },
                    descriptions: {
                        project: 'Submit a new project idea',
                        suggestion: 'Share your suggestions with us',
                        complaint: 'Report an issue or problem',
                        general: 'General inquiries and feedback'
                    }
                },
                personalInfo: {
                    title: 'Personal Information',
                    subtitle: 'Share your thoughts with us',
                    name: 'Full Name',
                    phone: 'Phone Number',
                    next: 'Next',
                    prev: 'Previous',
                    requiredField: 'This field is required'
                },
                details: {
                    title: 'Details',
                    subtitle: 'Share your thoughts with us',
                    description: 'Description',
                    fileUpload: 'Upload File (PDF or Image)',
                    dragDrop: 'Drag and drop files here, or click to select files',
                    fileSize: 'Maximum file size: 10MB',
                    next: 'Next',
                    prev: 'Previous',
                    requiredField: 'This field is required'
                },
                confirmation: {
                    title: 'Confirmation',
                    subtitle: 'Share your thoughts with us',
                    reviewDetails: 'Review your submission details',
                    name: 'Full Name',
                    phone: 'Phone Number',
                    description: 'Description',
                    submit: 'Submit',
                    prev: 'Previous'
                },
                success: {
                    success: 'Thank you for your feedback!',
                    message: 'Your request has been submitted successfully. We will get back to you shortly.',
                    referenceId: 'Reference ID:'
                },
                locationModal: {
                    title: 'Location Access',
                    subtitle: 'Enable precise location services',
                    description: 'We need your location to provide better service. This helps us connect you with services and information relevant to your area.',
                    allow: 'Allow',
                    deny: 'Deny',
                    footer: 'Your privacy is important to us. Your location data is only used to enhance your experience.'
                },
                languageModal: {
                    title: 'Select Language',
                    subtitle: 'Choose your preferred language',
                    footer: 'Your language preference will be saved for future visits'
                }
            },
            ku: {
                header: {
                    title: 'فۆرمی فیدباک',
                    subtitle: 'یەکێتی نیشتیمانیی کوردستان'
                },
                footer: {
                    copyright: '© 2025 یەکێتی نیشتیمانیی کوردستان',
                    privacy: 'سیاسەتی تایبەتمەندی',
                    terms: 'مەرجەکانی خزمەتگوزاری',
                    contact: 'پەیوەندی'
                },
                progressSteps: [
                    'جۆری داواکاری',
                    'زانیاری کەسی',
                    'وردەکاری',
                    'دڵنیاکردنەوە'
                ],
                requestType: {
                    title: 'جۆری داواکاری',
                    subtitle: 'بیروڕاکانت لەگەڵ ئێمە هاوبەش بکە',
                    next: 'دواتر',
                    requestTypes: {
                        project: 'پڕۆژە',
                        suggestion: 'پێشنیار',
                        complaint: 'سکاڵا',
                        general: 'داواکاری گشتی'
                    },
                    descriptions: {
                        project: 'پێشکەشکردنی بیرۆکەی پڕۆژەیەکی نوێ',
                        suggestion: 'هاوبەشکردنی پێشنیارەکانت لەگەڵ ئێمە',
                        complaint: 'ڕاپۆرتکردنی کێشە یان گرفتێک',
                        general: 'پرسیار و فیدباکی گشتی'
                    }
                },
                personalInfo: {
                    title: 'زانیاری کەسی',
                    subtitle: 'بیروڕاکانت لەگەڵ ئێمە هاوبەش بکە',
                    name: 'ناوی تەواو',
                    phone: 'ژمارەی تەلەفۆن',
                    next: 'دواتر',
                    prev: 'پێشتر',
                    requiredField: 'ئەم بەشە پێویستە'
                },
                details: {
                    title: 'وردەکاری',
                    subtitle: 'بیروڕاکانت لەگەڵ ئێمە هاوبەش بکە',
                    description: 'وەسف',
                    fileUpload: 'بارکردنی فایل (PDF یان وێنە)',
                    dragDrop: 'فایلەکان ڕاکێشە و فڕێدە ئێرە، یان کلیک بکە بۆ هەڵبژاردنی فایلەکان',
                    fileSize: 'قەبارەی فایل: 10MB',
                    next: 'دواتر',
                    prev: 'پێشتر',
                    requiredField: 'ئەم بەشە پێویستە'
                },
                confirmation: {
                    title: 'دڵنیاکردنەوە',
                    subtitle: 'بیروڕاکانت لەگەڵ ئێمە هاوبەش بکە',
                    reviewDetails: 'پێداچوونەوەی وردەکاریەکانی ناردن',
                    name: 'ناوی تەواو',
                    phone: 'ژمارەی تەلەفۆن',
                    description: 'وەسف',
                    submit: 'ناردن',
                    prev: 'پێشتر'
                },
                success: {
                    success: 'سوپاس بۆ فیدباکەکەت!',
                    message: 'داواکاریەکەت بە سەرکەوتوویی نێردرا. بە زوویی وەڵامت دەدەینەوە.',
                    referenceId: 'ژمارەی داواکاری:'
                },
                locationModal: {
                    title: 'دەستگەیشتن بە شوێن',
                    subtitle: 'چالاککردنی خزمەتگوزاریەکانی شوێنی ورد',
                    description: 'ئێمە پێویستمان بە شوێنی ئێوەیە بۆ پێشکەشکردنی خزمەتگوزاری باشتر. ئەمە یارمەتیمان دەدات بۆ پەیوەندی کردن لەگەڵ خزمەتگوزاریەکان و زانیاریەکانی پەیوەندیدار بە ناوچەکەت.',
                    allow: 'ڕێگەدان',
                    deny: 'ڕەتکردنەوە',
                    footer: 'تایبەتمەندی ئێوە گرنگە بۆ ئێمە. داتای شوێنی ئێوە تەنها بەکاردێت بۆ باشترکردنی ئەزموونەکەت.'
                },
                languageModal: {
                    title: 'زمان هەڵبژێرە',
                    subtitle: 'زمانی دڵخوازی خۆت هەڵبژێرە',
                    footer: 'هەڵبژاردنی زمانەکەت بۆ سەردانەکانی داهاتوو پاشەکەوت دەکرێت'
                }
            },
            ar: {
                header: {
                    title: 'نموذج التعليقات',
                    subtitle: 'الاتحاد الوطني الكردستاني'
                },
                footer: {
                    copyright: '© 2025 الاتحاد الوطني الكردستاني',
                    privacy: 'سياسة الخصوصية',
                    terms: 'شروط الخدمة',
                    contact: 'اتصل بنا'
                },
                progressSteps: [
                    'نوع الطلب',
                    'المعلومات الشخصية',
                    'التفاصيل',
                    'التأكيد'
                ],
                requestType: {
                    title: 'نوع الطلب',
                    subtitle: 'شارك أفكارك معنا',
                    next: 'التالي',
                    requestTypes: {
                        project: 'مشروع',
                        suggestion: 'اقتراح',
                        complaint: 'شكوى',
                        general: 'طلب عام'
                    },
                    descriptions: {
                        project: 'قدم فكرة مشروع جديدة',
                        suggestion: 'شارك اقتراحاتك معنا',
                        complaint: 'الإبلاغ عن مشكلة',
                        general: 'استفسارات وملاحظات عامة'
                    }
                },
                personalInfo: {
                    title: 'المعلومات الشخصية',
                    subtitle: 'شارك أفكارك معنا',
                    name: 'الاسم الكامل',
                    phone: 'رقم الهاتف',
                    next: 'التالي',
                    prev: 'السابق',
                    requiredField: 'هذا الحقل مطلوب'
                },
                details: {
                    title: 'التفاصيل',
                    subtitle: 'شارك أفكارك معنا',
                    description: 'الوصف',
                    fileUpload: 'تحميل ملف (PDF أو صورة)',
                    dragDrop: 'اسحب الملفات وأفلتها هنا، أو انقر لتحديد الملفات',
                    fileSize: 'الحد الأقصى لحجم الملف: 10 ميجابايت',
                    next: 'التالي',
                    prev: 'السابق',
                    requiredField: 'هذا الحقل مطلوب'
                },
                confirmation: {
                    title: 'التأكيد',
                    subtitle: 'شارك أفكارك معنا',
                    reviewDetails: 'مراجعة تفاصيل الطلب',
                    name: 'الاسم الكامل',
                    phone: 'رقم الهاتف',
                    description: 'الوصف',
                    submit: 'إرسال',
                    prev: 'السابق'
                },
                success: {
                    success: 'شكرا لك على ملاحظاتك!',
                    message: 'تم تقديم طلبك بنجاح. سنرد عليك قريبًا.',
                    referenceId: 'رقم المرجع:'
                },
                locationModal: {
                    title: 'الوصول إلى الموقع',
                    subtitle: 'تمكين خدمات الموقع الدقيقة',
                    description: 'نحتاج إلى موقعك لتقديم خدمة лучше. هذا يساعدنا на توصيلك بالخدمات والمعلومات ذات الصلة بمنطقتك.',
                    allow: 'السماح',
                    deny: 'رفض',
                    footer: 'خصوصيتك مهمة بالنسبة لنا. يتم استخدام بيانات موقعك فقط لتحسين تجربتك.'
                },
                languageModal: {
                    title: 'اختر اللغة',
                    subtitle: 'اختر لغتك المفضلة',
                    footer: 'سيتم حفظ تفضيل اللغة الخاص بك للزيارات المستقبلية'
                }
            }
        };
        
        // Language options
        const languages = [
            {
                code: 'ku',
                name: 'کوردی',
                localName: 'Kurdistan',
                flag: 'https://upload.wikimedia.org/wikipedia/commons/3/35/Flag_of_Kurdistan.svg',
                color: 'from-green-400 to-green-600'
            },
            {
                code: 'ar',
                name: 'العربية',
                localName: 'Iraq',
                flag: 'https://flagcdn.com/w80/iq.png',
                color: 'from-green-500 to-green-700'
            },
            {
                code: 'en',
                name: 'English',
                localName: 'United States',
                flag: 'https://flagcdn.com/w80/us.png',
                color: 'from-green-400 to-green-600'
            }
        ];
        
        // Request type options
        const requestTypeOptions = [
            {
                id: 'project',
                icon: '<i data-lucide="file-text" class="w-5 h-5 sm:w-6 sm:h-6"></i>',
                color: 'request-type-project',
                lightColor: 'bg-blue-50',
                borderColor: 'border-blue-100',
                iconColor: 'text-blue-500',
                delay: 0.1
            },
            {
                id: 'suggestion',
                icon: '<i data-lucide="lightbulb" class="w-5 h-5 sm:w-6 sm:h-6"></i>',
                color: 'request-type-suggestion',
                lightColor: 'bg-yellow-50',
                borderColor: 'border-yellow-100',
                iconColor: 'text-yellow-500',
                delay: 0.2
            },
            {
                id: 'complaint',
                icon: '<i data-lucide="alert-triangle" class="w-5 h-5 sm:w-6 sm:h-6"></i>',
                color: 'request-type-complaint',
                lightColor: 'bg-red-50',
                borderColor: 'border-red-100',
                iconColor: 'text-red-500',
                delay: 0.3
            },
            {
                id: 'general',
                icon: '<i data-lucide="message-square" class="w-5 h-5 sm:w-6 sm:h-6"></i>',
                color: 'request-type-general',
                lightColor: 'bg-green-50',
                borderColor: 'border-green-100',
                iconColor: 'text-green-500',
                delay: 0.4
            }
        ];
        
        // Initialize the app
        function initApp() {
            renderProgressBar();
            renderFormContent();
            setupEventListeners();
            updateAllTexts();
            
            // Show location modal after a delay
            setTimeout(() => {
                document.getElementById('locationModal').classList.remove('hidden');
            }, 500);
        }
        
        // Update all texts based on current language
        function updateAllTexts() {
            const text = texts[state.currentLanguage];
            
            // Update header
            document.getElementById('headerTitle').textContent = text.header.title;
            document.getElementById('headerSubtitle').textContent = text.header.subtitle;
            
            // Update footer
            document.getElementById('footerCopyright').textContent = text.footer.copyright;
            document.getElementById('footerPrivacy').textContent = text.footer.privacy;
            document.getElementById('footerTerms').textContent = text.footer.terms;
            document.getElementById('footerContact').textContent = text.footer.contact;
            
            // Update language button
            document.getElementById('languageButtonText').textContent = 
                state.currentLanguage === 'en' ? 'English' : 
                state.currentLanguage === 'ku' ? 'کوردی' : 'العربية';
            
            // Update location modal
            document.getElementById('locationModalTitle').textContent = text.locationModal.title;
            document.getElementById('locationModalSubtitle').textContent = text.locationModal.subtitle;
            document.getElementById('locationModalDescription').textContent = text.locationModal.description;
            document.getElementById('locationAllowButton').querySelector('span').textContent = text.locationModal.allow;
            document.getElementById('locationDenyButton').querySelector('span').textContent = text.locationModal.deny;
            document.getElementById('locationModalFooter').textContent = text.locationModal.footer;
            
            // Update language modal
            document.getElementById('languageModalTitle').textContent = text.languageModal.title;
            document.getElementById('languageModalSubtitle').textContent = text.languageModal.subtitle;
            document.getElementById('languageModalFooter').textContent = text.languageModal.footer;
            
            // Re-render progress and form
            renderProgressBar();
            renderFormContent();
        }
        
        // Render progress bar
        function renderProgressBar() {
            const progressSteps = document.getElementById('progressSteps');
            const progressBar = document.getElementById('progressBar');
            const progressPercentage = document.getElementById('progressPercentage');
            
            const steps = texts[state.currentLanguage].progressSteps;
            const progress = (state.currentStep / (steps.length - 1)) * 100;
            
            progressBar.style.width = `${progress}%`;
            progressPercentage.style.left = `${progress}%`;
            progressPercentage.querySelector('div').textContent = `${Math.round(progress)}%`;
            
            let stepsHTML = '';
            steps.forEach((step, index) => {
                const isActive = index <= state.currentStep;
                const isCompleted = index < state.currentStep;
                
                stepsHTML += `
                    <div class="flex flex-col items-center ${isActive ? 'text-green-600' : 'text-gray-400'}">
                        <div class="w-8 h-8 sm:w-10 sm:h-10 rounded-full flex items-center justify-center mb-1 sm:mb-2 transition-all duration-500 relative ${isActive ? 'bg-gradient-to-br from-green-400 to-green-600 text-white shadow-lg shadow-green-200' : 'bg-gray-100 text-gray-400 border border-gray-200'}">
                            ${isCompleted ? '<i data-lucide="check" class="w-4 h-4 sm:w-5 sm:h-5"></i>' : `<span class="text-xs sm:text-sm">${index + 1}</span>`}
                            ${index === state.currentStep ? '<div class="absolute -inset-1 rounded-full border-2 border-green-400/50 animate-ping opacity-30"></div>' : ''}
                        </div>
                        <div class="text-center space-y-1">
                            <span class="hidden md:block text-xs sm:text-sm font-medium">${step}</span>
                            ${index < steps.length - 1 ? `
                                <div class="hidden md:block w-full h-0.5 bg-gray-100">
                                    <div class="h-full bg-green-500 transition-all duration-700 ${index < state.currentStep ? 'w-full' : 'w-0'}"></div>
                                </div>
                            ` : ''}
                        </div>
                    </div>
                `;
            });
            
            progressSteps.innerHTML = stepsHTML;
            lucide.createIcons();
        }
        
        // Render form content based on current step
        function renderFormContent() {
            const formContent = document.getElementById('formContent');
            
            if (state.submitted) {
                formContent.innerHTML = renderSuccess();
            } else {
                switch (state.currentStep) {
                    case 0:
                        formContent.innerHTML = renderRequestType();
                        break;
                    case 1:
                        formContent.innerHTML = renderPersonalInfo();
                        break;
                    case 2:
                        formContent.innerHTML = renderDetails();
                        break;
                    case 3:
                        formContent.innerHTML = renderConfirmation();
                        break;
                    default:
                        formContent.innerHTML = renderRequestType();
                }
            }
            
            lucide.createIcons();
        }
        
        // Render request type step
        function renderRequestType() {
            const text = texts[state.currentLanguage].requestType;
            const directionClass = state.direction === 'rtl' ? 'flex-row-start text-right' : 'text-left';
            
            let optionsHTML = '';
            requestTypeOptions.forEach(type => {
                const isSelected = state.formData.requestType === type.id;
                const animationDelay = 0.3 + type.delay;
                const animationDirection = state.direction === 'rtl' ? 'Right' : 'Left';
                
                optionsHTML += `
                    <div class="animate-slideIn${animationDirection}" style="animation-delay: ${animationDelay}s;">
                        <button onclick="selectRequestType('${type.id}')" data-type="${type.id}" class="w-full p-4 sm:p-6 rounded-xl sm:rounded-2xl transition-all duration-300 flex items-center gap-3 sm:gap-5 ${directionClass} request-type-card ${isSelected ? 'selected ' + type.color + ' text-white shadow-lg' : 'bg-white border ' + type.borderColor + ' hover:shadow-md'} group relative overflow-hidden">
                            <div class="absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent -translate-x-full group-hover:translate-x-full transition-transform duration-1000"></div>
                            <div class="w-12 h-12 sm:w-16 sm:h-16 flex items-center justify-center rounded-lg sm:rounded-xl transition-all duration-500 ${isSelected ? 'bg-white/20' : type.lightColor} group-hover:scale-110">
                                <div class="${isSelected ? 'text-white' : type.iconColor}">${type.icon}</div>
                                ${isSelected ? '<div class="absolute inset-0 border-2 border-white/30 rounded-lg sm:rounded-xl animate-ping opacity-30"></div>' : ''}
                            </div>
                            <div>
                                <span class="font-bold text-base sm:text-lg block mb-0.5 sm:mb-1">${text.requestTypes[type.id]}</span>
                                <span class="text-xs sm:text-sm ${isSelected ? 'text-white/80' : 'text-gray-500'}">${text.descriptions[type.id]}</span>
                            </div>
                        </button>
                    </div>
                `;
            });
            
            return `
                <div class="w-full animate-fadeIn" style="animation-delay: 0.2s;">
                    <div class="flex flex-col ${state.direction === 'rtl' ? 'items-start' : 'items-start'} mb-6 sm:mb-8 animate-slideInDown" style="animation-delay: 0.3s;">
                        <div class="flex items-center gap-2 mb-2">
                            <i data-lucide="sparkles" class="w-4 h-4 sm:w-5 sm:h-5 text-green-500 animate-float" style="animation-delay: 0s;"></i>
                            <h2 class="text-2xl sm:text-3xl font-bold text-gray-800">${text.title}</h2>
                        </div>
                        <p class="text-sm sm:text-base text-gray-500">${text.subtitle}</p>
                        <div class="h-1 w-16 sm:w-20 bg-gradient-to-r from-green-400 to-green-600 rounded-full mt-2 sm:mt-3"></div>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-3 sm:gap-5" id="requestTypeOptions">
                        ${optionsHTML}
                    </div>
                    <div class="mt-6 sm:mt-10 flex justify-end animate-slideInUp" style="animation-delay: 0.5s;">
                        <button onclick="nextStep()" ${!state.formData.requestType ? 'disabled' : ''} class="px-6 sm:px-8 py-3 sm:py-4 rounded-lg sm:rounded-xl bg-gradient-to-r from-green-500 to-green-600 text-white font-medium text-sm sm:text-base hover:from-green-600 hover:to-green-700 transition-all shadow-lg shadow-green-500/20 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2 sm:gap-3 relative overflow-hidden group">
                            <div class="absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent -translate-x-full group-hover:translate-x-full transition-transform duration-1000"></div>
                            <span>${text.next}</span>
                            ${state.direction === 'rtl' ? '<i data-lucide="arrow-left" class="w-4 h-4 sm:w-5 sm:h-5 animate-pulse-slow"></i>' : '<i data-lucide="arrow-right" class="w-4 h-4 sm:w-5 sm:h-5 animate-pulse-slow"></i>'}
                        </button>
                    </div>
                </div>
            `;
        }
        
        // Render personal info step
        function renderPersonalInfo() {
            const text = texts[state.currentLanguage].personalInfo;
            const directionClass = state.direction === 'rtl' ? 'text-right' : 'text-left';
            const iconPosition = state.direction === 'rtl' ? 'right-3 sm:right-5' : 'left-3 sm:left-5';
            const checkPosition = state.direction === 'rtl' ? 'left-3 sm:left-5' : 'right-3 sm:right-5';
            
            return `
                <div class="w-full animate-fadeIn">
                    <div class="flex flex-col ${state.direction === 'rtl' ? 'items-start' : 'items-start'} mb-6 sm:mb-8">
                        <h2 class="text-2xl sm:text-3xl font-bold text-gray-800">${text.title}</h2>
                        <p class="text-sm sm:text-base text-gray-600 mt-1 sm:mt-2">${text.subtitle}</p>
                        <div class="h-1 w-16 sm:w-20 bg-gradient-to-r from-green-400 to-green-600 rounded-full mt-2 sm:mt-3"></div>
                    </div>
                    <div class="space-y-5 sm:space-y-8">
                        <div class="relative">
                            <div class="absolute ${state.direction === 'rtl' ? 'right-0' : 'left-0'} -top-2 w-full h-full bg-green-50/50 rounded-xl sm:rounded-2xl -z-10 transform rotate-1"></div>
                            <div class="bg-white rounded-xl sm:rounded-2xl border border-gray-200 shadow-sm p-4 sm:p-6 relative overflow-hidden">
                                <div class="absolute top-0 inset-x-0 h-1 bg-gradient-to-r from-green-400 to-green-600"></div>
                                <div>
                                    <label class="block mb-1.5 sm:mb-2 font-medium text-sm sm:text-base text-gray-700 ${directionClass}" for="name">${text.name}</label>
                                    <div class="relative">
                                        <div class="absolute ${iconPosition} top-1/2 -translate-y-1/2 text-gray-500">
                                            <i data-lucide="user" class="w-4 h-4 sm:w-5 sm:h-5"></i>
                                        </div>
                                        <input type="text" id="name" value="${state.formData.name}" oninput="updateFormData('name', this.value)" class="w-full ${state.direction === 'rtl' ? 'pr-10 sm:pr-12 pl-10 sm:pl-12' : 'pl-10 sm:pl-12 pr-10 sm:pr-12'} py-3 sm:py-4 rounded-lg sm:rounded-xl border text-sm sm:text-base border-gray-300 focus:ring-green-500 focus:border-green-500 outline-none transition-all duration-200 ${directionClass}" placeholder="${text.name}..." dir="${state.direction}">
                                        ${state.formData.name ? `
                                            <div class="absolute ${checkPosition} top-1/2 -translate-y-1/2 text-green-500">
                                                <i data-lucide="check" class="w-4 h-4 sm:w-5 sm:h-5"></i>
                                            </div>
                                        ` : ''}
                                        <p id="nameError" class="mt-1 sm:mt-2 text-xs sm:text-sm text-red-600 ${directionClass} hidden">${text.requiredField}</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="relative">
                            <div class="absolute ${state.direction === 'rtl' ? 'right-0' : 'left-0'} -top-2 w-full h-full bg-green-50/50 rounded-xl sm:rounded-2xl -z-10 transform -rotate-1"></div>
                            <div class="bg-white rounded-xl sm:rounded-2xl border border-gray-200 shadow-sm p-4 sm:p-6 relative overflow-hidden">
                                <div class="absolute top-0 inset-x-0 h-1 bg-gradient-to-r from-green-400 to-green-600"></div>
                                <div>
                                    <label class="block mb-1.5 sm:mb-2 font-medium text-sm sm:text-base text-gray-700 ${directionClass}" for="phone">${text.phone}</label>
                                    <div class="relative">
                                        <div class="absolute ${iconPosition} top-1/2 -translate-y-1/2 text-gray-500">
                                            <i data-lucide="phone" class="w-4 h-4 sm:w-5 sm:h-5"></i>
                                        </div>
                                        <input type="tel" id="phone" value="${state.formData.phone}" oninput="updateFormData('phone', this.value)" class="w-full ${state.direction === 'rtl' ? 'pr-10 sm:pr-12 pl-10 sm:pl-12' : 'pl-10 sm:pl-12 pr-10 sm:pr-12'} py-3 sm:py-4 rounded-lg sm:rounded-xl border text-sm sm:text-base border-gray-300 focus:ring-green-500 focus:border-green-500 outline-none transition-all duration-200 ${directionClass}" placeholder="${text.phone}..." dir="${state.direction}">
                                        ${state.formData.phone ? `
                                            <div class="absolute ${checkPosition} top-1/2 -translate-y-1/2 text-green-500">
                                                <i data-lucide="check" class="w-4 h-4 sm:w-5 sm:h-5"></i>
                                            </div>
                                        ` : ''}
                                        <p id="phoneError" class="mt-1 sm:mt-2 text-xs sm:text-sm text-red-600 ${directionClass} hidden">${text.requiredField}</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="mt-6 sm:mt-10 flex justify-between">
                        <button onclick="prevStep()" class="px-4 sm:px-8 py-2.5 sm:py-4 rounded-lg sm:rounded-xl bg-gray-100 text-gray-700 font-medium hover:bg-gray-200 transition-all flex items-center gap-2 sm:gap-3 text-sm sm:text-base">
                            ${state.direction === 'rtl' ? '<i data-lucide="arrow-right" class="w-4 h-4 sm:w-5 sm:h-5"></i>' : '<i data-lucide="arrow-left" class="w-4 h-4 sm:w-5 sm:h-5"></i>'}
                            <span>${text.prev}</span>
                        </button>
                        <button onclick="validatePersonalInfo()" class="px-4 sm:px-8 py-2.5 sm:py-4 rounded-lg sm:rounded-xl bg-gradient-to-r from-green-500 to-green-600 text-white font-medium hover:from-green-600 hover:to-green-700 transition-all shadow-lg shadow-green-500/30 flex items-center gap-2 sm:gap-3 text-sm sm:text-base">
                            <span>${text.next}</span>
                            ${state.direction === 'rtl' ? '<i data-lucide="arrow-left" class="w-4 h-4 sm:w-5 sm:h-5 animate-pulse-slow"></i>' : '<i data-lucide="arrow-right" class="w-4 h-4 sm:w-5 sm:h-5 animate-pulse-slow"></i>'}
                        </button>
                    </div>
                </div>
            `;
        }
        
        // Render details step
        function renderDetails() {
            const text = texts[state.currentLanguage].details;
            const directionClass = state.direction === 'rtl' ? 'text-right' : 'text-left';
            const iconPosition = state.direction === 'rtl' ? 'right-3 sm:right-5' : 'left-3 sm:left-5';
            const checkPosition = state.direction === 'rtl' ? 'left-3 sm:left-5' : 'right-3 sm:right-5';
            
            return `
                <div class="w-full animate-fadeIn">
                    <div class="flex flex-col ${state.direction === 'rtl' ? 'items-start' : 'items-start'} mb-6 sm:mb-8">
                        <h2 class="text-2xl sm:text-3xl font-bold text-gray-800">${text.title}</h2>
                        <p class="text-sm sm:text-base text-gray-600 mt-1 sm:mt-2">${text.subtitle}</p>
                        <div class="h-1 w-16 sm:w-20 bg-gradient-to-r from-green-400 to-green-600 rounded-full mt-2 sm:mt-3"></div>
                    </div>
                    <div class="space-y-5 sm:space-y-8">
                        <div class="relative">
                            <div class="absolute ${state.direction === 'rtl' ? 'right-0' : 'left-0'} -top-2 w-full h-full bg-green-50/50 rounded-xl sm:rounded-2xl -z-10 transform rotate-1"></div>
                            <div class="bg-white rounded-xl sm:rounded-2xl border border-gray-200 shadow-sm p-4 sm:p-6 relative overflow-hidden">
                                <div class="absolute top-0 inset-x-0 h-1 bg-gradient-to-r from-green-400 to-green-600"></div>
                                <div>
                                    <label class="block mb-1.5 sm:mb-2 font-medium text-sm sm:text-base text-gray-700 ${directionClass}" for="description">${text.description}</label>
                                    <div class="relative">
                                        <div class="absolute ${iconPosition} top-4 sm:top-5 text-gray-500">
                                            <i data-lucide="message-square" class="w-4 h-4 sm:w-5 sm:h-5"></i>
                                        </div>
                                        <textarea id="description" rows="4" oninput="updateFormData('description', this.value)" class="w-full ${state.direction === 'rtl' ? 'pr-10 sm:pr-12 pl-10 sm:pl-12' : 'pl-10 sm:pl-12 pr-10 sm:pr-12'} py-3 sm:py-4 rounded-lg sm:rounded-xl border text-sm sm:text-base border-gray-300 focus:ring-green-500 focus:border-green-500 outline-none transition-all duration-200 resize-none ${directionClass}" placeholder="${text.description}..." dir="${state.direction}">${state.formData.description}</textarea>
                                        ${state.formData.description ? `
                                            <div class="absolute ${checkPosition} top-4 sm:top-5 text-green-500">
                                                <i data-lucide="check" class="w-4 h-4 sm:w-5 sm:h-5"></i>
                                            </div>
                                        ` : ''}
                                        <p id="descriptionError" class="mt-1 sm:mt-2 text-xs sm:text-sm text-red-600 ${directionClass} hidden">${text.requiredField}</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="relative">
                            <div class="absolute ${state.direction === 'rtl' ? 'right-0' : 'left-0'} -top-2 w-full h-full bg-green-50/50 rounded-xl sm:rounded-2xl -z-10 transform -rotate-1"></div>
                            <div class="bg-white rounded-xl sm:rounded-2xl border border-gray-200 shadow-sm p-4 sm:p-6 relative overflow-hidden">
                                <div class="absolute top-0 inset-x-0 h-1 bg-gradient-to-r from-green-400 to-green-600"></div>
                                <div>
                                    <label class="block mb-1.5 sm:mb-2 font-medium text-sm sm:text-base text-gray-700 ${directionClass}">${text.fileUpload}</label>
                                    <div class="dropzone border-2 border-dashed border-gray-300 rounded-lg sm:rounded-xl p-6 sm:p-8 transition-all duration-200 cursor-pointer hover:border-green-500 hover:bg-green-50 relative overflow-hidden group" onclick="document.getElementById('fileInput').click()">
                                        <input type="file" id="fileInput" class="file-input-hidden" multiple onchange="handleFileSelect(this.files)">
                                        <div class="absolute inset-0 bg-gradient-to-r from-green-100/0 via-green-100/30 to-green-100/0 -translate-x-full group-hover:translate-x-full transition-transform duration-1000 ease-in-out"></div>
                                        <div class="flex flex-col items-center justify-center gap-3 sm:gap-4 text-gray-500 relative">
                                            <div class="bg-green-100 p-3 sm:p-4 rounded-full animate-float">
                                                <i data-lucide="upload" class="w-5 h-5 sm:w-6 sm:h-6 text-green-500"></i>
                                            </div>
                                            <p class="text-center text-xs sm:text-sm">${text.dragDrop}</p>
                                            <p class="text-xs text-gray-400">${text.fileSize}</p>
                                        </div>
                                    </div>
                                    <div id="filePreviewContainer" class="file-preview-container mt-4">
                                        ${renderFilePreviews()}
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="mt-6 sm:mt-10 flex justify-between">
                        <button onclick="prevStep()" class="px-4 sm:px-8 py-2.5 sm:py-4 rounded-lg sm:rounded-xl bg-gray-100 text-gray-700 font-medium hover:bg-gray-200 transition-all flex items-center gap-2 sm:gap-3 text-sm sm:text-base">
                            ${state.direction === 'rtl' ? '<i data-lucide="arrow-right" class="w-4 h-4 sm:w-5 sm:h-5"></i>' : '<i data-lucide="arrow-left" class="w-4 h-4 sm:w-5 sm:h-5"></i>'}
                            <span>${text.prev}</span>
                        </button>
                        <button onclick="validateDetails()" class="px-4 sm:px-8 py-2.5 sm:py-4 rounded-lg sm:rounded-xl bg-gradient-to-r from-green-500 to-green-600 text-white font-medium hover:from-green-600 hover:to-green-700 transition-all shadow-lg shadow-green-500/30 flex items-center gap-2 sm:gap-3 text-sm sm:text-base">
                            <span>${text.next}</span>
                            ${state.direction === 'rtl' ? '<i data-lucide="arrow-left" class="w-4 h-4 sm:w-5 sm:h-5 animate-pulse-slow"></i>' : '<i data-lucide="arrow-right" class="w-4 h-4 sm:w-5 sm:h-5 animate-pulse-slow"></i>'}
                        </button>
                    </div>
                </div>
            `;
        }
        
        // Render file previews
        function renderFilePreviews() {
            if (!state.formData.files || state.formData.files.length === 0) {
                return '';
            }
            
            return state.formData.files.map((file, index) => `
                <div class="file-preview">
                    <i data-lucide="file-text" class="w-4 h-4 text-green-500"></i>
                    <span class="truncate max-w-xs">${file.name}</span>
                    <button onclick="removeFile(${index})" class="file-preview-remove">
                        <i data-lucide="x" class="w-4 h-4"></i>
                    </button>
                </div>
            `).join('');
        }
        
        // Handle file selection
        function handleFileSelect(files) {
            if (!files || files.length === 0) return;
            
            // Convert FileList to Array and add to state
            const newFiles = Array.from(files);
            state.formData.files = [...state.formData.files, ...newFiles];
            
            // Update preview
            document.getElementById('filePreviewContainer').innerHTML = renderFilePreviews();
            lucide.createIcons();
        }
        
        // Remove file
        function removeFile(index) {
            state.formData.files.splice(index, 1);
            document.getElementById('filePreviewContainer').innerHTML = renderFilePreviews();
            lucide.createIcons();
        }
        
        // Render confirmation step
        function renderConfirmation() {
            const text = texts[state.currentLanguage].confirmation;
            const requestTypes = texts[state.currentLanguage].requestType.requestTypes;
            const directionClass = state.direction === 'rtl' ? 'flex-row-start' : '';
            
            const getRequestIcon = () => {
                switch (state.formData.requestType) {
                    case 'project': return '<i data-lucide="file-text" class="w-5 h-5 sm:w-6 sm:h-6 text-white"></i>';
                    case 'suggestion': return '<i data-lucide="lightbulb" class="w-5 h-5 sm:w-6 sm:h-6 text-white"></i>';
                    case 'complaint': return '<i data-lucide="alert-triangle" class="w-5 h-5 sm:w-6 sm:h-6 text-white"></i>';
                    case 'general': return '<i data-lucide="message-square" class="w-5 h-5 sm:w-6 sm:h-6 text-white"></i>';
                    default: return '<i data-lucide="message-square" class="w-5 h-5 sm:w-6 sm:h-6 text-white"></i>';
                }
            };
            
            const getRequestColor = () => {
                switch (state.formData.requestType) {
                    case 'project': return 'request-type-project';
                    case 'suggestion': return 'request-type-suggestion';
                    case 'complaint': return 'request-type-complaint';
                    case 'general': return 'request-type-general';
                    default: return 'request-type-general';
                }
            };
            
            return `
                <div class="w-full animate-fadeIn">
                    <div class="flex flex-col ${state.direction === 'rtl' ? 'items-start' : 'items-start'} mb-6 sm:mb-8">
                        <h2 class="text-2xl sm:text-3xl font-bold text-gray-800">${text.title}</h2>
                        <p class="text-sm sm:text-base text-gray-600 mt-1 sm:mt-2">${text.subtitle}</p>
                        <div class="h-1 w-16 sm:w-20 bg-gradient-to-r from-green-400 to-green-600 rounded-full mt-2 sm:mt-3"></div>
                    </div>
                    <div class="relative">
                        <div class="absolute ${state.direction === 'rtl' ? 'right-0' : 'left-0'} -top-2 w-full h-full bg-green-50/50 rounded-xl sm:rounded-2xl -z-10 transform rotate-1"></div>
                        <div class="bg-white rounded-xl sm:rounded-2xl border border-gray-200 overflow-hidden shadow-lg relative">
                            <div class="absolute top-0 inset-x-0 h-1 bg-gradient-to-r from-green-400 to-green-600"></div>
                            <div class="p-4 sm:p-6 ${getRequestColor()}">
                                <div class="flex items-center gap-3 sm:gap-4 ${directionClass}">
                                    <div class="bg-white/20 p-2 sm:p-3 rounded-lg backdrop-blur-sm">
                                        ${getRequestIcon()}
                                    </div>
                                    <div>
                                        <h3 class="text-lg sm:text-xl font-bold text-white">${requestTypes[state.formData.requestType]}</h3>
                                        <p class="text-white/80 text-xs sm:text-sm">${text.reviewDetails}</p>
                                    </div>
                                </div>
                            </div>
                            <div class="p-4 sm:p-6 space-y-4 sm:space-y-6">
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 sm:gap-6">
                                    <div class="bg-gray-50 p-3 sm:p-5 rounded-lg sm:rounded-xl">
                                        <h4 class="text-xs sm:text-sm font-medium text-gray-500 mb-1 sm:mb-2 flex items-center gap-2 ${directionClass}">
                                            <i data-lucide="user" class="w-3.5 h-3.5 sm:w-4 sm:h-4 text-gray-400"></i>
                                            ${text.name}
                                        </h4>
                                        <p class="text-gray-800 font-medium text-sm sm:text-base">${state.formData.name}</p>
                                    </div>
                                    <div class="bg-gray-50 p-3 sm:p-5 rounded-lg sm:rounded-xl">
                                        <h4 class="text-xs sm:text-sm font-medium text-gray-500 mb-1 sm:mb-2 flex items-center gap-2 ${directionClass}">
                                            <i data-lucide="phone" class="w-3.5 h-3.5 sm:w-4 sm:h-4 text-gray-400"></i>
                                            ${text.phone}
                                        </h4>
                                        <p class="text-gray-800 font-medium text-sm sm:text-base">${state.formData.phone}</p>
                                    </div>
                                </div>
                                <div class="bg-gray-50 p-3 sm:p-5 rounded-lg sm:rounded-xl">
                                    <h4 class="text-xs sm:text-sm font-medium text-gray-500 mb-1 sm:mb-2 flex items-center gap-2 ${directionClass}">
                                        <i data-lucide="message-circle" class="w-3.5 h-3.5 sm:w-4 sm:h-4 text-gray-400"></i>
                                        ${text.description}
                                    </h4>
                                    <p class="text-gray-800 whitespace-pre-wrap bg-white p-3 sm:p-4 rounded-md sm:rounded-lg border border-gray-100 text-sm sm:text-base">${state.formData.description}</p>
                                </div>
                                ${state.formData.files.length > 0 ? `
                                    <div class="bg-gray-50 p-3 sm:p-5 rounded-lg sm:rounded-xl">
                                        <h4 class="text-xs sm:text-sm font-medium text-gray-500 mb-1 sm:mb-2 flex items-center gap-2 ${directionClass}">
                                            <i data-lucide="paperclip" class="w-3.5 h-3.5 sm:w-4 sm:h-4 text-gray-40"></i>
                                            فایلەکان
                                        </h4>
                                        <div class="file-preview-container">
                                            ${renderFilePreviews()}
                                        </div>
                                    </div>
                                ` : ''}
                            </div>
                        </div>
                    </div>
                    <div class="mt-6 sm:mt-10 flex justify-between">
                        <button onclick="prevStep()" class="px-4 sm:px-8 py-2.5 sm:py-4 rounded-lg sm:rounded-xl bg-gray-100 text-gray-700 font-medium hover:bg-gray-200 transition-all flex items-center gap-2 sm:gap-3 text-sm sm:text-base">
                            <i data-lucide="arrow-left" class="w-4 h-4 sm:w-5 sm:h-5"></i>
                            <span>${text.prev}</span>
                        </button>
                        <button onclick="submitForm()" class="px-4 sm:px-8 py-2.5 sm:py-4 rounded-lg sm:rounded-xl bg-gradient-to-r from-green-500 to-green-600 text-white font-medium hover:from-green-600 hover:to-green-700 transition-all shadow-lg shadow-green-500/30 flex items-center gap-2 sm:gap-3 text-sm sm:text-base">
                            <span>${text.submit}</span>
                            <div class="w-4 h-4 sm:w-5 sm:h-5"></div>
                        </button>
                    </div>
                </div>
            `;
        }
        
        // Render success screen
        function renderSuccess() {
            const text = texts[state.currentLanguage].success;
            const refId = `PUK-${Math.floor(Math.random() * 100000).toString().padStart(5, '0')}`;
            
            return `
                <div class="w-full flex flex-col items-center justify-center py-8 sm:py-12 text-center animate-fadeIn">
                    <div class="relative">
                        <div class="absolute inset-0 bg-green-100/50 rounded-full blur-3xl animate-pulse"></div>
                        <div class="relative w-20 h-20 sm:w-28 sm:h-28 rounded-full bg-gradient-to-br from-green-400 to-green-600 flex items-center justify-center mb-6 sm:mb-8 shadow-xl shadow-green-500/20">
                            <i data-lucide="check" class="w-10 h-10 sm:w-12 sm:h-12 text-white"></i>
                        </div>
                    </div>
                    <div class="text-center max-w-md">
                        <h2 class="text-2xl sm:text-3xl font-bold text-gray-800 mb-3 sm:mb-4">${text.success}</h2>
                        <p class="text-sm sm:text-base text-gray-600 mb-6 sm:mb-8">${text.message}</p>
                        <div class="px-4 sm:px-6 py-2 sm:py-3 rounded-full bg-green-100 text-green-600 text-xs sm:text-sm font-medium flex items-center justify-center gap-2 mx-auto">
                            <span>${text.referenceId} ${refId}</span>
                            <i data-lucide="check" class="w-3.5 h-3.5 sm:w-4 sm:h-4"></i>
                        </div>
                    </div>
                </div>
            `;
        }
        
        // Render language modal options
        function renderLanguageOptions() {
            const languageOptions = document.getElementById('languageOptions');
            let optionsHTML = '';
            
            languages.forEach((lang, index) => {
                const isCurrent = lang.code === state.currentLanguage;
                const animationDelay = 0.2 + index * 0.1;
                
                optionsHTML += `
                    <div class="animate-slideInRight" style="animation-delay: ${animationDelay}s;">
                        <button onclick="selectLanguage('${lang.code}')" class="w-full flex items-center gap-4 sm:gap-5 p-4 sm:p-5 rounded-lg sm:rounded-xl transition-all duration-300 ${isCurrent ? `bg-gradient-to-r ${lang.color} text-white shadow-lg` : 'bg-white border border-gray-100 hover:border-green-200 hover:bg-green-50'} group relative overflow-hidden">
                            <div class="absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent -translate-x-full group-hover:translate-x-full transition-transform duration-1000"></div>
                            <div class="w-12 h-12 sm:w-14 sm:h-14 rounded-full overflow-hidden flex items-center justify-center ${isCurrent ? 'bg-white/20' : 'bg-gray-100'} shadow-md group-hover:shadow-lg transition-all border-2 ${isCurrent ? 'border-white/30' : 'border-transparent'}">
                                <img src="${lang.flag}" alt="${lang.localName} Flag" class="w-full h-full object-cover">
                            </div>
                            <div class="flex-1">
                                <span class="font-medium text-base sm:text-lg block ${isCurrent ? 'text-white' : 'text-gray-800'}">${lang.name}</span>
                                <span class="text-xs sm:text-sm ${isCurrent ? 'text-white/80' : 'text-gray-500'}">${lang.localName}</span>
                            </div>
                            ${isCurrent ? `
                                <div class="bg-white/20 w-7 h-7 sm:w-8 sm:h-8 rounded-full flex items-center justify-center">
                                    <i data-lucide="check" class="w-4 h-4 sm:w-5 sm:h-5 text-white"></i>
                                </div>
                            ` : ''}
                        </button>
                    </div>
                `;
            });
            
            languageOptions.innerHTML = optionsHTML;
            lucide.createIcons();
        }
        
        // Setup event listeners
        function setupEventListeners() {
            document.getElementById('languageButton').addEventListener('click', () => {
                document.getElementById('languageModal').classList.remove('hidden');
                renderLanguageOptions();
            });
            
            document.getElementById('locationAllowButton').addEventListener('click', () => {
                document.getElementById('locationModal').classList.add('hidden');
            });
            
            document.getElementById('locationDenyButton').addEventListener('click', () => {
                document.getElementById('locationModal').classList.add('hidden');
            });
            
            // Close modals when clicking outside
            document.addEventListener('click', (e) => {
                if (e.target.id === 'locationModal') {
                    document.getElementById('locationModal').classList.add('hidden');
                }
                if (e.target.id === 'languageModal') {
                    document.getElementById('languageModal').classList.add('hidden');
                }
            });
        }
        
        // Update form data
        function updateFormData(field, value) {
            state.formData[field] = value;
            
            // Clear error if field is filled
            if (value.trim() !== '') {
                const errorElement = document.getElementById(`${field}Error`);
                if (errorElement) {
                    errorElement.classList.add('hidden');
                    document.getElementById(field).classList.remove('validation-error');
                }
            }
        }
        
        // Select request type
        function selectRequestType(type) {
            state.formData.requestType = type;
            
            // Update UI without reloading - use data attributes to identify cards
            const cards = document.querySelectorAll('.request-type-card');
            cards.forEach(card => {
                const cardType = card.getAttribute('data-type');
                const typeConfig = requestTypeOptions.find(t => t.id === cardType);
                
                if (cardType === type) {
                    // Add selected class and color class
                    card.classList.add('selected');
                    card.classList.add(typeConfig.color);
                    card.classList.remove('bg-white', typeConfig.borderColor);
                    
                    // Update text colors
                    const textElements = card.querySelectorAll('span');
                    textElements.forEach(el => {
                        if (el.classList.contains('text-gray-500')) {
                            el.classList.remove('text-gray-500');
                            el.classList.add('text-white/80');
                        }
                    });
                    
                    // Update icon container
                    const iconContainer = card.querySelector('div > div:first-child');
                    if (iconContainer) {
                        iconContainer.classList.remove(typeConfig.lightColor);
                        iconContainer.classList.add('bg-white/20');
                    }
                    
                    // Update icon
                    const icon = card.querySelector('div > div:first-child > div');
                    if (icon) {
                        icon.classList.remove(typeConfig.iconColor);
                        icon.classList.add('text-white');
                    }
                } else {
                    // Remove selected class and color class
                    card.classList.remove('selected');
                    card.classList.remove(typeConfig.color);
                    card.classList.add('bg-white', typeConfig.borderColor);
                    
                    // Update text colors
                    const textElements = card.querySelectorAll('span');
                    textElements.forEach(el => {
                        if (el.classList.contains('text-white/80')) {
                            el.classList.remove('text-white/80');
                            el.classList.add('text-gray-500');
                        }
                    });
                    
                    // Update icon container
                    const iconContainer = card.querySelector('div > div:first-child');
                    if (iconContainer) {
                        iconContainer.classList.remove('bg-white/20');
                        iconContainer.classList.add(typeConfig.lightColor);
                    }
                    
                    // Update icon
                    const icon = card.querySelector('div > div:first-child > div');
                    if (icon) {
                        icon.classList.remove('text-white');
                        icon.classList.add(typeConfig.iconColor);
                    }
                }
            });
            
            // Enable next button
            document.querySelector('button[onclick="nextStep()"]').disabled = false;
        }
        
        // Navigate to next step
        function nextStep() {
            if (state.currentStep < 3) {
                state.currentStep++;
                renderProgressBar();
                renderFormContent();
            }
        }
        
        // Navigate to previous step
        function prevStep() {
            if (state.currentStep > 0) {
                state.currentStep--;
                renderProgressBar();
                renderFormContent();
            }
        }
        
        // Validate personal info
        function validatePersonalInfo() {
            let isValid = true;
            
            if (!state.formData.name.trim()) {
                document.getElementById('nameError').classList.remove('hidden');
                document.getElementById('name').classList.add('validation-error');
                isValid = false;
            } else {
                document.getElementById('nameError').classList.add('hidden');
                document.getElementById('name').classList.remove('validation-error');
            }
            
            if (!state.formData.phone.trim()) {
                document.getElementById('phoneError').classList.remove('hidden');
                document.getElementById('phone').classList.add('validation-error');
                isValid = false;
            } else {
                document.getElementById('phoneError').classList.add('hidden');
                document.getElementById('phone').classList.remove('validation-error');
            }
            
            if (isValid) {
                nextStep();
            }
        }
        
        // Validate details
        function validateDetails() {
            if (!state.formData.description.trim()) {
                document.getElementById('descriptionError').classList.remove('hidden');
                document.getElementById('description').classList.add('validation-error');
                return;
            } else {
                document.getElementById('descriptionError').classList.add('hidden');
                document.getElementById('description').classList.remove('validation-error');
            }
            
            nextStep();
        }
        
        // Submit form
        function submitForm() {
            state.submitted = true;
            state.currentStep = 0;
            renderProgressBar();
            renderFormContent();
        }
        
        // Select language
        function selectLanguage(lang) {
            state.currentLanguage = lang;
            state.direction = (lang === 'ku' || lang === 'ar') ? 'rtl' : 'ltr';
            
            // Update UI
            document.body.dir = state.direction;
            
            // Update all texts
            updateAllTexts();
            
            // Close modal
            document.getElementById('languageModal').classList.add('hidden');
        }
        
        // Initialize the app when the page loads
        window.addEventListener('DOMContentLoaded', initApp);
        
        // Make functions available globally
        window.updateFormData = updateFormData;
        window.selectRequestType = selectRequestType;
        window.nextStep = nextStep;
        window.prevStep = prevStep;
        window.validatePersonalInfo = validatePersonalInfo;
        window.validateDetails = validateDetails;
        window.submitForm = submitForm;
        window.selectLanguage = selectLanguage;
        window.handleFileSelect = handleFileSelect;
        window.removeFile = removeFile;
    </script>
</body>
</html>
